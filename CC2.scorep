#!/bin/bash

if [ -z $SCOREP_WRAPPER ] ;then
    echo "SCOREP_WRAPPER must be set to on or off, exiting..."
    exit 0
fi

set -x
if [ $SCOREP_WRAPPER = "on" ] ;then

    echo "$@" |egrep -q -- "-E |-M " ;isdep=$?
    if [ $isdep = 0 ] ;then
        `which CC` "$@"
    else
        `which scorep` --cuda --mpp=mpi --keep-files -v `which CC` "$@"
    fi
    
else
    `which CC` "$@"
fi
set +x
